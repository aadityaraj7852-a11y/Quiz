<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>MCQ JSON → DOCX Generator</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.4.1/html-docx.js"></script>

  <style>
    body { font-family: Arial; margin: 20px; }
    textarea { width: 100%; height: 300px; font-family: monospace; }
    button { padding: 10px 16px; margin-top: 10px; }
  </style>
</head>
<body>

<h2>MCQ JSON → DOCX Converter</h2>

<textarea id="jsonInput" placeholder="यहाँ अपना JSON डालें..."></textarea>
<br>
<button onclick="generateDocx()">Generate DOCX</button>

<script>
function generateDocx() {
    let raw = document.getElementById("jsonInput").value;

    let data;
    try {
        data = JSON.parse(raw);
    } catch (e) {
        alert("Invalid JSON");
        return;
    }

    let html = "<html><body>";

    data.forEach((q, i) => {
        html += `
### section: ${q.section || ""}
<br>
# hindi_directions: ${q.hindi_directions || ""}
<br><br>
# Question ${i+1}: ${q.question || ""}
<br><br>

# Options
<br>
###A: ${q.options?.A || ""}
<br>
###B: ${q.options?.B || ""}
<br>
###C: ${q.options?.C || ""}
<br>
###D: ${q.options?.D || ""}
<br><br>

# correct_option: ${q.correct_option || ""}
<br><br>

# Solution: ${q.solution || ""}
<br><hr><br>
        `;
    });

    html += "</body></html>";

    let blob = window.htmlDocx.asBlob(html);
    let link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "mcq_output.docx";
    link.click();
}
</script>

</body>
</html>
